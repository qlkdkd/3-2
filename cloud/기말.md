# Amazon RDS
## 1. Amazon RDS란?
* Amazon Relational Database Service는 AWS에서 제공하는 관리형 데이터베이스
  * 관리의 복잡성 줄이고, 고가용성과 확장성을 갖춘 RDBS를 손쉽게 구축, 운영, 확장할 수 있도록 지원
 
### 1.1 주요 특징
#### 1. 관리형 서비스
* 설치, 유지관리, 백업, 소프트웨어 패치 등을 자동으로 처리
  * 사용자는 데이터베이스 서버의 설정이나 운영체제 관리에 신경쓰지 않고, 애플리케이션 개발과 데이터베이스 사용에만 집중할 수 있음
 
#### 2. 다양한 데이터베이스 엔진 지원
* 여러 인기있는 관계형 데이터베이스 지원
  * Amazon Aurora, MySQL, PostgreSQL등
* Amazon Aurora는 MySQL과 PostgreSQL과 호환되며, 고성능과 자동 확장 기능 제공

#### 3. 고가용성 및 자동 복구
* RDS는 Multi-AZ배포 기능 통해 고가용성 제공
    * 데이터베이스 인스턴스를 기본 영역과 대기 영역에 자동으로 복제하여 장애 발생 시 대기 인스턴스로 자동으로 장애 조치를 수행함
    * Amazon RDS가 다른 가용 영역에서 등기식 대기 복제본을 자동으로 프로비저닝하고 유지 관리하는 다중 AZ DB 인스턴스 배포
 
![image](https://github.com/user-attachments/assets/38468a48-021b-4a47-b405-a0562b4e3140)

* Multi-AZ배포는 데이터베이스의 자동 복구와 장애 조치 지원-> 서비스 중단 최소화
* 읽기 복제본 기능: 데이터베이스의 읽기 부하 분산 -> 읽기 집중형 APP성능 향상
  * AWS리전에 있는 3개의 개별 가용 영역에 라이터 DB인스턴스 2개와 리더 DB 인스턴스가 있는 다중 AZ DB 클러스터 배포
    * 3개의 DB인스턴스 모두 읽기 트래픽 처리 가능
 
![image](https://github.com/user-attachments/assets/706384e2-8f3d-495c-8a89-f140272ff041)

#### 4. 확장성
* 스토리지 자동 확장
  * Amazon Aurora, MySQL, MariaDB, PostgreSQL같은 엔진에서 사용 가능
  * DB용량 자동으로 늘릴 수 있음
* 컴퓨팅 리소스 확장
  * 서버리스 환경에서 컴퓨팅 리소스를 자동으로 조정할 수 있는 옵션 제공
  * 데이터베이스의 워크로드에 따라 자동으로 용량이 확장 및 축소
  * 서버리스 모드에서는 데이터베이스가 활성화되면 필요한 만큼의 컴퓨팅 리소스를 자동으로 할당
  * 트래픽이 적거나 없을 때는 자동으로 리소스를 축소하여 비용 절감
 
#### 5. 보안
* RDS는 IAM과 통합되어 사용자가 데이터베이스 인스턴스에 접근할 수 있는 권한 제어 가능
* VPC(가상 프라이빗 클라우드)와 통합
  * RDS인스턴스를 네트워크 내에서 안전하게 배포 가능
  * VPC보안 그룹을 사용해 데이터베이스에 대한 접근 제한 가능
 
* 예제: ec2-rds-x VPC보안 그룹을 사용하여 클라이언트 애플리케이션의 IP주소를 소스로 사용하는 인바운드 규칙 정의
  * 애플리케이션은 이 보안 그룹에 속함
  * rds-ec2-x라는 이름의 보조 보안 그룹은 ec2-rds-x를 소스로 지정하고 RDS DB인스턴스에 연결함
  * 보안 그룹 규칙에 따르면 클라이언트 애플리케이션은 DB인스턴스에 직접 액세스할 수 없지만, EC2인스턴스는 DBㅇㄴ스턴스에 액세스할 수 있음

![image](https://github.com/user-attachments/assets/c3f4e626-552e-4b17-b859-feff3be4f5c3)

* TLS(Transport Layer Security)를 통해 데이터 전송 중 암호화를 제공하며, AWS KMS(AWS Key Management Service)를 사용하여 데이터베이스 암호화 지원
* 데이터베이스 인스턴스, 자동 백업, 스냅샷을 수동으로 생성할 수 있으며, 스냅샷은 필요할 때 새로운 데이터베이스 인스턴스로 복원 가능

* ### 1.2. Amazon RDS 구성요소
* #### DB 인스턴스
* * Amazon RDS의 기본 구성요소로서, 클라우드에 있는 격리된 데이터베이스 환경
    * 사용자가 만든 여러 데이터베이스 포함
    * 기존 도구 및 애플리케이션(예: 표준 SQL 클라이언트)을 통해 DB 인스턴스에 접근 가능
    * AWS 명령행 인터페이스(CLI), Amazon RDS API, AWS Management Console을 사용해 DB인스턴스를 만들고 수정할 수 있음
* 하나의 DB인스턴스는 선택한 데이터베이스 엔진을 실행하며, 이 인스턴스 위에 여러 데이터베이스를 생성할 수 있음
* DB인스턴스 클래스: DB인스턴스의 CPU및 메모리 용량 결정
* DB인스턴스의 스토리지
  * 5GB에서 6TB까지 용량 선택 가능
  * 마그네틱, 범용 및 프로비저닝 된 등 세 가지 유형
* 아마존의 VPC서비스를 사용해 가상 사설 클라우드에서 DB인스턴스를 실행 가능

#### 보안 그룹
* DB인스턴스에 대한 액세스를 제어
  * 사용자가 지정한 IP주소 범위 또는 Amazon EC2인스턴스에서 액세스할 수 있도록 허용하는 방법으로 제어
* Amazon RDS는 DB보안 그룹, VPC보안그룹 및 EC2보안그룹을 사용
  * DB보안그룹은 VPC외부의 DB 인스턴스에 대한 엑세스 제어
  * VPC보안그룹은 VPC내부의 DB 인스턴스에 대한 액세스 제어
  * EC2보안그룹은 EC2 인스턴스에 대한 엑세스 제어, DB인스턴스와 함께 사용
 
![image](https://github.com/user-attachments/assets/cac98ade-04fc-4862-9acf-4d3cf94e173b)

#### DB 파라미터 그룹
* DB 파라미터 그룹을 사용해 DB엔진의 구성을 관리
* 인스턴스 유형이 같은 하나 이상의 DB인스턴스에 적용할 수 있는 엔진 구성 값을 포함
* DB인스턴스를 만들 때 DB파라미터 그룹을 지정하지 않으면 Amazon RDS가 기본 DB파라미터 그룹을 적용
  * 기본 그룹에는 특정 데이터베이스 엔진 및 DB인스턴스의 인스턴스 클래스에 대한 기본값이 포함

#### DB옵션 그룹
* 일부 DB엔진은 데이터베이스를 간편하게 관리하고 데이터를 적극 활용할 수 있는 추가 기능 제공
* Amazon RDS는 DB옵션 그룹을 사용하여 이러한 기능을 활성화하고 구성

---

# 디바이스 섀도우
## 개요
* 사물: 물리적 디바이스를 클라우드에서 표현하고 기록한 것. 물리적 디바이스와 AWS IOT의 호환을 위해서는 사물 레코드 필요
* AWS IoT디바이스 섀도우 서비스는 AWS IoT 사물 객체에 섀도우 추가
* 섀도우: 디바이스, 앱 및 기타 클라우드 서비스가 데이터를 공유할 수 있는 신뢰할 수 있는 데이터 스토어 제공
  * AWS IoT에 연결되어 있는 동안 디바이스, 앱 및 기타 클라우드 서비스가 해당 섀도우를 통해 디바이스의 현재 상태에 액세스하고 제어할 수 있음
 
![image](https://github.com/user-attachments/assets/9465feef-b0f7-4215-9f52-a2cc7b4f6e5d)

* 섀도우를 사용하면 디바이스가 AWS IoT에 연결되어 있는지 여부에 관계없이 앱 및 기타 서비스에서 디바이스의 상태를 사용할 수 있음
  * 디바이스 다시 연결: 섀도우의 현새 상태 수신-> 섀도우와 일치하도록 상태를 업데이트-> 업데이트된 상태로 메시지 게시
  * 앱이 오프라인 전환되고 디바이스 상태가 변경된 경우: 디바이스 섀도우는 섀도우를 업데이터하여 앱이 다시 연결될 때 섀도우에 현재 상태를 쿼리하도록 할 수 있음

## 디바이스 섀도우 서비스를 이용한 디바이스 상태 수집 및 제어
### 디바이스 섀도우 서비스
* 디바이스 섀도우 서비스는 중간 역할을 수행하여 디바이스와 애플리케이션이 디바이스의 현재 상태 정보를 검색하고 업데이트할 수 있게 함
* AWS IoT는 디바이스 섀도우 작업을 위한 세 가지 메서드 제공
  * Update
    * 디아비스 섀도우가 존재하지 않을 경우 디바이스 섀도우 생성
    * 요청에 의해 요구된 데이터로 디바이스 섀도우의 내용 변경
    * 데이터는 마지막으로 변경된 시간을 나타내는 타임 스탬프 정보와 함께 저장됨
  * GET
    * 디바이스 섀도우에 저장된 최신 상태 검색
    * 메타데이터를 포함하여 전체 JSON문서 반환
  * DELETE
    * 디바이스 섀도우를 모든 내용을 포함하여 삭제
### 디바이스 섀도우 서비스 사용 시나리오
* 디바이스 상태가 변경되는 경우
* * 애플리케이션이 디바이스의 상태 변경을 요청하는 경우
